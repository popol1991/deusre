<!DOCTYPE html>
<html lang='en' ng-app="filter">
<head>
    <meta charset='utf-8'>
    <title>Scientific Data Search</title>
    <link rel='stylesheet' href='/static/css/reset.css'>
    <link rel='stylesheet' href='/static/css/index.css'>
    <script src="/static/js/jquery.min.js"></script>
    <script src="/static/js/parsley.min.js"></script>
    <script src="/static/js/angular.min.js"></script>
    <script src="/static/js/filter.js"></script>
    <script>
        function toggle(id) {
            $("tbody#"+id).toggle();
        };
        function addfilter() {
            var res = $(".results-container");
            var newtop = String(parseInt(res.css("padding-top").slice(0,-2)) + 40) + "px";
            res.css("padding-top", newtop);
        };
    </script>
</head>

<!-- Title and search box -->
<header class="jumbotron">
  <h1 class="title"><a>EAGER</a></h1>
  <div class="search-box-container" data-ng-controller='filterCtrl'>
      <form data-parsley-validate action="./" method="get">
          <a class="about right" href="http://boston.lti.cs.cmu.edu/eager/deusre/neurosci/">ABOUT</a>
        <input type="submit" class="search-button" value="Search">
        <input type='text' name="q" class="search-box" placeholder="Keywords" value="{{ params['q'] }}" autofocus>
        <table class="filter">
		<tr ng-repeat="filter in filterlist">
            <td><select ng-model="filter.selected" required ng-options="item as item.label for item in filters track by item.id">
            </select></td>
            <td><input data-parsley-type="number" name="{[ filter.selected.name ]}_min"/></td>
            <td><input data-parsley-type="number" name="{[ filter.selected.name]}_max"/></td>
		</tr>
        <tr>
            <td class="dummy">Filter:</td>
            <td class="dummy"><input disabled/></td>
            <td class="dummy"><input disabled/></td>
            <td><button class="addFilter" type="button" onclick="addfilter()" ng-click="addFilter()">Add Filter</button></td>
		</tr>
		</table>
    </form>
  </div>
</header>

<!-- Listing of search results -->
<main class="results-container">
    {% if params and len != 0 %}
    <h2 class="qtype">This is a {{ qtype }} query.</h2>
    {% endif  %}
    {% if params and len == 0 and q in params and len(params[q]) != 0 %}
    <p>No results found.</p>
    {% endif  %}
  <section class='results'>
    {% for hit in hits %}
    <article class='result'>
      <!--<h2>{{ hit.id}}</h2>-->
      <h2>{{ hit.caption }}</h2>
      <h3>From: {{ hit['article-title']}}</h3>
      <!--<p>{{hit.journal}}, {{hit.issn}}, {{hit.volume}}, {{hit.issue}}, {{hit.page}}, {{hit.date}}</p>-->
      <!--<p>-->
          <!--<b>Authors: </b>-->
          <!--<span>{{ ", ".join(hit.authors) }}</span>-->
      <!--</p>-->
      <!--<p>-->
          <!--<b>Keywords: </b>-->
          <!--<span>{{ ", ".join(hit.keywords) }}</span>-->
      <!--</p>-->
      <br>
      <table>
          <thead>
            {% for row in hit.header_rows %}
              <tr>
                {% for header in row %}
                  <th>
                    {{ header.value }}
                  </th>
                {% endfor %}
              </tr>
            {% endfor %}
          </thead>
          <tbody id="{{ hit.id }}" style="display:none">
          {% if 'data_rows' in hit %}
              {% for row in hit.data_rows %}
              <tr>
                  {% if row %}
                    {% for value in row %}
                        <td id="cell" class="highlight_{{ value.highlight }}">
                        {{ value.text }}
                        </td>
                    {% endfor %}
                  {% endif %}
              </tr>
              {% endfor %}
          {% endif %}
          </tbody>
      </table>
      <a class="toggle" onclick="toggle({{hit.id}})">Show/Hide table.</a>
    </article>
    {% endfor %}
  </section>
</main>

<!-- Load resources -->
</body>
</html>
